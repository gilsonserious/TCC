{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from \"@angular/core\";\nimport { finalize } from \"rxjs/operators\";\nlet PedidosComponent = class PedidosComponent {\n  constructor(afs, afAuth, storage) {\n    this.afs = afs;\n    this.afAuth = afAuth;\n    this.storage = storage;\n    this.pedidos = [];\n    this.config = {\n      nome: null,\n      whatsapp: null,\n      color: null,\n      logo: null,\n      banner: null\n    };\n    this.selectedFile = null;\n    this.selectedFile2 = null;\n  } //Upload do logo\n\n\n  onFileSelected(event) {\n    var n = Date.now();\n    const file = event.target.files[0];\n    const filePath = `imagems/${n}`;\n    const fileRef = this.storage.ref(filePath);\n    const task = this.storage.upload(`imagems/${n}`, file);\n    task.snapshotChanges().pipe(finalize(() => {\n      this.downloadURL = fileRef.getDownloadURL();\n      this.downloadURL.subscribe(url => {\n        //Salva a URL gerada para o arquivo\n        if (url) {\n          this.fb = url;\n          this.config.logo = this.fb;\n        }\n      });\n    })).subscribe(url => {\n      if (url) {\n        console.log(url);\n      }\n    });\n  } //Upload do banner\n\n\n  onFileSelected2(event) {\n    var n = Date.now();\n    const file = event.target.files[0];\n    const filePath = `imagems/${n}`;\n    const fileRef = this.storage.ref(filePath);\n    const task = this.storage.upload(`imagems/${n}`, file);\n    task.snapshotChanges().pipe(finalize(() => {\n      this.downloadURL2 = fileRef.getDownloadURL();\n      this.downloadURL2.subscribe(url => {\n        //Salva a URL gerada para o arquivo\n        if (url) {\n          this.fb2 = url;\n          this.config.banner = this.fb;\n        }\n      });\n    })).subscribe(url => {\n      if (url) {\n        console.log(url);\n      }\n    });\n  }\n\n  carregar() {\n    this.afs.firestore.collection('config').doc('config').get().then(d => {\n      this.config = JSON.parse(JSON.stringify(d.data()));\n    }); //Listar pedidos em tempo real\n\n    this.afs.collection('pedidos', ref => ref.orderBy('data', 'desc')).snapshotChanges().subscribe(r => {\n      let pedidos = [];\n      r.forEach(rr => {\n        let item = rr.payload.doc.data();\n        item['id'] = rr.payload.doc.id;\n        pedidos.push(item);\n      });\n      console.log('pedidos', pedidos);\n      this.pedidos = pedidos;\n    });\n  }\n\n  ngOnInit() {\n    // this.afAuth.signInAnonymously().then(() => {\n    this.carregar(); // })\n  }\n\n  aceitar(id) {\n    this.afs.firestore.collection('pedidos').doc(id).update({\n      status: 'preparando'\n    }).then(() => {\n      this.carregar();\n    });\n  }\n\n  recusar(id) {\n    this.afs.firestore.collection('pedidos').doc(id).update({\n      status: 'recusado'\n    }).then(() => {\n      this.carregar();\n    });\n  }\n\n  saiuEntrega(id) {\n    this.afs.firestore.collection('pedidos').doc(id).update({\n      status: 'saiu para entrega'\n    }).then(() => {\n      this.carregar();\n    });\n  }\n\n  finalizado(id) {\n    this.afs.firestore.collection('pedidos').doc(id).update({\n      status: 'entregue'\n    }).then(() => {\n      this.carregar();\n    });\n  }\n\n  salvar() {\n    this.afs.firestore.collection('config').doc('config').update(this.config);\n  }\n\n};\nPedidosComponent = __decorate([Component({\n  selector: \"app-pedidos\",\n  templateUrl: \"./pedidos.component.html\"\n})], PedidosComponent);\nexport { PedidosComponent };","map":null,"metadata":{},"sourceType":"module"}
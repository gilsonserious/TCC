{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, Input } from \"@angular/core\";\nimport { finalize } from \"rxjs/operators\";\nimport 'firebase/firestore'; // import {AlertModalService} from '../../shared/alert-modal.service';\n// import { EventEmitter } from \"stream\";\n\nlet SettingsComponent = class SettingsComponent {\n  constructor(storage, afs, afAuth, auth) {\n    this.storage = storage;\n    this.afs = afs;\n    this.afAuth = afAuth;\n    this.auth = auth;\n    this._color = \"light\";\n    this.novo = false;\n    this.listar = false;\n    this.perfil = false;\n    this.dados = [];\n    this.usuarios = [];\n    this.categorias = [];\n    this.usuario = {\n      nome: null,\n      senha: null,\n      email: null,\n      imagem: null,\n      celular: null,\n      username: null,\n      uid: null\n    };\n    this.title = \"cloudsSorage\";\n    this.selectedFile = null;\n    this.opcional = null;\n  }\n\n  get color() {\n    return this._color;\n  }\n\n  set color(color) {\n    this._color = color !== \"light\" && color !== \"dark\" ? \"light\" : color;\n  }\n\n  carregar() {\n    //Listar Usuarios\n    this.afs.firestore.collection('usuarios').get().then(r => {\n      let users = [];\n      r.forEach(rr => {\n        let obj = rr.data();\n        obj['id'] = rr.id;\n        users.push(obj);\n      });\n      this.usuarios = users;\n      console.log(this.usuarios);\n    });\n  }\n\n  ngOnInit() {\n    // this.afAuth.signInAnonymously();\n    this.carregar();\n  }\n\n  testandoo(id) {\n    this.perfil = true;\n\n    var teste = cliente => cliente.uid == id;\n\n    this.dados = this.usuarios.filter(teste);\n    console.log(this.dados);\n  }\n\n  listarUsers() {\n    this.listar = true;\n  } //Upload de imagem\n\n\n  onFileSelected(event) {\n    var n = Date.now();\n    const file = event.target.files[0];\n    const filePath = `imagems/${n}`;\n    const fileRef = this.storage.ref(filePath);\n    const task = this.storage.upload(`imagems/${n}`, file);\n    task.snapshotChanges().pipe(finalize(() => {\n      this.downloadURL = fileRef.getDownloadURL();\n      this.downloadURL.subscribe(url => {\n        //Salva a URL gerada para o arquivo\n        if (url) {\n          this.fb = url;\n          this.usuario.imagem = this.fb;\n        }\n      });\n    })).subscribe(url => {\n      if (url) {\n        console.log(url);\n      }\n    });\n  }\n\n  salvar() {\n    if (this.usuario.nome && this.usuario.email && this.usuario.senha && this.usuario.username) {\n      this.auth.signup({\n        email: this.usuario.email,\n        password: this.usuario.senha\n      }).then(res => {\n        if (res.user.uid) {\n          this.carregar();\n          this.novo = false;\n          this.auth.saveDetails(this.usuario = {\n            nome: this.usuario.nome,\n            email: this.usuario.email,\n            senha: this.usuario.senha,\n            celular: this.usuario.celular,\n            imagem: this.usuario.imagem,\n            username: this.usuario.username,\n            uid: res.user.uid\n          }).then(res => {\n            alert('Conta Criada!');\n            this.usuario = {\n              nome: null,\n              email: null,\n              senha: null,\n              celular: null,\n              imagem: null,\n              username: null,\n              uid: null\n            };\n          }, err => {\n            console.log(this.auth.verificarErro(err));\n            alert(this.auth.verificarErro(err.error));\n          });\n        }\n      }, err => {\n        let str = err.toString().replace(/.*\\(|\\).*/g, '');\n        console.log(str); // Pega o que est√° entre parenteses\n\n        alert(this.auth.verificarErro(str));\n      });\n    } else {\n      alert('Por favor, preencha todos os campos');\n    }\n  }\n\n};\n\n__decorate([Input()], SettingsComponent.prototype, \"color\", null);\n\nSettingsComponent = __decorate([Component({\n  selector: \"app-settings\",\n  templateUrl: \"./settings.component.html\"\n})], SettingsComponent);\nexport { SettingsComponent };","map":null,"metadata":{},"sourceType":"module"}